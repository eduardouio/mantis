{% extends 'base/base.html' %}
{% load static %}
{% block style %}
<link rel="stylesheet" href="{% static 'css/app/vehicle.css' %}">
{% endblock %}
{% block content %}
<div id="vehicleApp"></div>

{% block script %}
<script>
  // Limpiar instancias previas antes de cargar datos
  if (window.vehicleAppInstance) {
    window.vehicleAppInstance = null;
  }
  
  // Datos del contexto Django para Vue
  window.vehicleChoices = {
    type_vehicle: {{ form.type_vehicle.field.choices|safe }},
    owner_transport: {{ form.owner_transport.field.choices|safe }},
    status_vehicle: {{ form.status_vehicle.field.choices|safe }},
    certifications: [],
    passes: []
  };
  
  {% if vehicle %}
  try {
    window.vehicleData = {
      vehicle: {{ vehicle|safe }},
      certifications: {{ vehicle.certificationvehicle_set.all|safe }},
      passes: {{ vehicle.passvehicle_set.all|safe }}
    };
  } catch(e) {
    console.warn('Error loading vehicle data:', e);
    window.vehicleData = null;
  }
  {% endif %}
</script>
<script src="{% static 'js/app/vehicle_app.js' %}"></script>
{% endblock %}
{% endblock %}
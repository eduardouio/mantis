<form method="POST" action="">
    {% csrf_token %}
    
    <!-- Formulario del proyecto (maestro) -->
    <div class="row">
      <!-- Columna 1 -->
      <div class="col-md-4">
        <div class="mb-3">
          <label for="id_internal_code" class="form-label">Código Interno</label>
          <input type="text" class="form-control form-control-sm" id="id_internal_code" name="internal_code" maxlength="100" required>
        </div>
        <div class="mb-3">
          <label for="id_partner" class="form-label">Cliente (Socio de Negocio)</label>
          <select class="form-select form-control-sm" id="id_partner" name="partner">
            {% for partner in partners %}
            <option value="{{ partner.id }}">{{ partner.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="mb-3">
          <label for="id_required_by" class="form-label">Requerido por</label>
          <input type="text" class="form-control form-control-sm" id="id_required_by" name="required_by" maxlength="255" required>
        </div>
        <div class="mb-3">
          <label for="id_autorized_by" class="form-label">Autorizado por</label>
          <input type="text" class="form-control form-control-sm" id="id_autorized_by" name="autorized_by" maxlength="255" required>
        </div>
      </div>
  
      <!-- Columna 2 -->
      <div class="col-md-4">
        <div class="mb-3">
          <label for="id_project_name" class="form-label">Nombre del Proyecto</label>
          <input type="text" class="form-control form-control-sm" id="id_project_name" name="project_name" maxlength="255" required>
        </div>
        <div class="mb-3">
          <label for="id_place" class="form-label">Lugar</label>
          <input type="text" class="form-control form-control-sm" id="id_place" name="place" maxlength="255" required>
        </div>
        <div class="mb-3">
          <label for="id_contact_name" class="form-label">Nombre de Contacto</label>
          <input type="text" class="form-control form-control-sm" id="id_contact_name" name="contact_name" maxlength="255" required>
        </div>
        <div class="mb-3">
          <label for="id_position_contact" class="form-label">Cargo de Contacto</label>
          <input type="text" class="form-control form-control-sm" id="id_position_contact" name="position_contact" maxlength="255" required>
        </div>
      </div>
  
      <!-- Columna 3 -->
      <div class="col-md-4">
        <div class="mb-3">
          <label for="id_phone_contact" class="form-label">Teléfono de Contacto</label>
          <input type="text" class="form-control form-control-sm" id="id_phone_contact" name="phone_contact" maxlength="15" required>
        </div>
        <div class="mb-3">
          <label for="id_start_date" class="form-label">Fecha de Inicio</label>
          <input type="date" class="form-control form-control-sm" id="id_start_date" name="start_date" required>
        </div>
        <div class="mb-3">
          <label for="id_end_date" class="form-label">Fecha de Fin</label>
          <input type="date" class="form-control form-control-sm" id="id_end_date" name="end_date" required>
        </div>
        <div class="mb-3">
          <label for="id_type_service" class="form-label">Tipo de Servicio</label>
          <select class="form-select form-control-sm" id="id_type_service" name="type_service">
            {% for choice in SERVICES_CHOICES %}
            <option value="{{ choice.0 }}">{{ choice.1 }}</option>
            {% endfor %}
          </select>
        </div>
      </div>
    </div>
  
    <!-- Línea divisoria -->
    <hr class="my-4">
  
    <!-- Formulario detalle (equipos relacionados al proyecto) -->
    <h5>Equipos Relacionados</h5>
    
    <div class="row">
      {{ formset.management_form }}
      {% for form in formset %}
        <div class="col-md-4">
          <div class="mb-3">
            <label for="{{ form.equipment.id_for_label }}" class="form-label">Equipo</label>
            {{ form.equipment|as_widget:class="form-select form-control-sm" }}
          </div>
          <div class="mb-3">
            <label for="{{ form.cost_rent.id_for_label }}" class="form-label">Costo de Alquiler</label>
            {{ form.cost_rent|as_widget:class="form-control form-control-sm" }}
          </div>
          <div class="mb-3">
            <label for="{{ form.cost_manteinance.id_for_label }}" class="form-label">Costo de Mantenimiento</label>
            {{ form.cost_manteinance|as_widget:class="form-control form-control-sm" }}
          </div>
          <div class="mb-3">
            <label for="{{ form.mantenace_frequency.id_for_label }}" class="form-label">Frecuencia de Mantenimiento</label>
            {{ form.mantenace_frequency|as_widget:class="form-control form-control-sm" }}
          </div>
          <div class="mb-3">
            <label for="{{ form.start_date.id_for_label }}" class="form-label">Fecha de Inicio Operaciones</label>
            {{ form.start_date|as_widget:class="form-control form-control-sm" }}
          </div>
          <div class="mb-3">
            <label for="{{ form.end_date.id_for_label }}" class="form-label">Fecha de Fin Operaciones</label>
            {{ form.end_date|as_widget:class="form-control form-control-sm" }}
          </div>
          <div class="form-check mb-3">
            <input type="checkbox" class="form-check-input form-control-sm" id="{{ form.is_active.id_for_label }}" name="{{ form.is_active.name }}" {% if form.is_active.value %}checked{% endif %}>
            <label class="form-check-label" for="{{ form.is_active.id_for_label }}">Equipo Activo</label>
          </div>
        </div>
      {% endfor %}
    </div>
  
    <!-- Botones -->
    <hr class="my-4">
    
    <div class="row mt-3">
      <div class="col text-center d-flex justify-content-between">
        <a href="#" class="btn btn-outline-secondary btn-sm">Cancelar</a>
        <button type="submit" class="btn btn-outline-success btn-sm">Guardar</button>
      </div>
    </div>
  </form>
  